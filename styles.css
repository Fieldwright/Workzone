/****************************************
 * PART 0 - CSS STYLES
 * START
 * 
 * Contains all styling for the application:
 * - CSS Variables (colors, spacing)
 * - Layout (grid, flexbox)
 * - Components (buttons, inputs, sections)
 * - Map customization
 * - Device markers (cones, signs)
 * - Field view GPS mode
 * - Animations and keyframes
 * - Print styles
 * - Responsive design
 ****************************************/

  :root { --bg:#0b1020; --panel:#111827; --muted:#9ca3af; --text:#e5e7eb; --accent:#60a5fa; --success:#22c55e; --warn:#f59e0b; --danger:#ef4444; }
  body.light-mode { 
    --bg:#f3f4f6; 
    --panel:#ffffff; 
    --muted:#6b7280; 
    --text:#111827; 
    --accent:#2563eb;
  }
  body.light-mode #map { filter: brightness(1.1); }
  body.light-mode .leaflet-control-layers,
  body.light-mode .leaflet-control-zoom a,
  body.light-mode .leaflet-control-scale { 
    background: white; 
    color: #111827; 
    border-color: #e5e7eb;
  }
  body.light-mode .section { border-color: #e5e7eb; }
  body.light-mode .section-header { background: #f9fafb; }
  body.light-mode input[type="number"],
  body.light-mode input[type="text"] { 
    background: #f9fafb; 
    border-color: #e5e7eb; 
    color: #111827;
  }
  body.light-mode .stat,
  body.light-mode .material-item,
  body.light-mode .phase-item,
  body.light-mode .history-item { 
    background: #f9fafb; 
    border-color: #e5e7eb;
  }
  body.light-mode .weather-widget { background: #f9fafb; border-color: #e5e7eb; }
  body.light-mode .progress-bar { background: #e5e7eb; }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--text);font:13px/1.25 system-ui,Segoe UI,Arial;transition:background 0.3s, color 0.3s}
  #app{display:grid;grid-template-columns:380px 1fr;min-height:100vh}
  aside{background:var(--panel);padding:10px 12px;border-right:1px solid #1f2937;overflow-y:auto;overflow-x:hidden;max-height:100vh}
  h1{font-size:16px;margin:0 0 4px;display:flex;align-items:center;gap:6px}
  .badge{display:inline-block;background:var(--accent);color:#000;padding:1px 5px;border-radius:4px;font-size:9px;font-weight:bold}
  .sub{color:var(--muted);font-size:11px;margin-bottom:8px;line-height:1.4}
  
  .section{margin:10px 0;border:1px solid #1f2937;border-radius:8px;overflow:hidden}
  .section-header{background:#1a2332;padding:8px 10px;cursor:pointer;display:flex;justify-content:space-between;align-items:center;user-select:none}
  .section-header:hover{background:#1f2937}
  .section-title{font-weight:600;font-size:13px;display:flex;align-items:center;gap:6px}
  .section-icon{font-size:10px;transition:transform 0.2s}
  .section-icon.collapsed{transform:rotate(-90deg)}
  .section-content{padding:10px;display:block}
  .section-content.collapsed{display:none}
  
  label{display:block;margin:4px 0 2px;color:#cbd5e1;font-size:12px;display:flex;align-items:center;gap:4px}
  .tooltip{color:var(--muted);cursor:help;font-size:10px}
  input[type="number"],input[type="text"]{width:100%;padding:6px 8px;border-radius:8px;border:1px solid #253041;background:#0b1220;color:#e5e7eb;font-size:12px}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-bottom:6px}
  .row3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:6px;margin-bottom:6px}
  .btns{display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-top:6px}
  .btns3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:6px;margin-top:6px}
  button{cursor:pointer;padding:8px;border:0;border-radius:10px;background:var(--accent);color:#03122a;font-weight:600;font-size:12px;transition:opacity 0.2s}
  button:hover{opacity:0.9}
  button.secondary{background:#374151;color:#e5e7eb}
  button.warn{background:var(--warn);color:#000}
  button.danger{background:var(--danger);color:#fff}
  button:disabled{opacity:0.5;cursor:not-allowed}
  .stat{margin-top:4px;font-size:12px;color:#cbd5e1;padding:4px 6px;background:#0b1220;border-radius:6px}
  .stat strong{color:var(--accent)}
  .hr{border-top:1px solid #1f2937;margin:8px 0}
  #map{height:100vh;width:100%}
  
  .leaflet-control-layers{background:var(--panel);border:2px solid var(--accent);border-radius:8px;padding:8px;box-shadow:0 2px 8px rgba(0,0,0,0.5)}
  .leaflet-control-layers-toggle{background-image:url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIHZpZXdCb3g9IjAgMCAzNiAzNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjZTVlN2ViIiBkPSJNIDYgOCBMIDMwIDggTCAzMCAxMCBMIDYgMTAgWiBNIDYgMTcgTCAzMCAxNyBMIDMwIDE5IEwgNiAxOSBaIE0gNiAyNiBMIDMwIDI2IEwgMzAgMjggTCA2IDI4IFoiLz48L3N2Zz4=');background-size:26px 26px;width:36px;height:36px}
  .leaflet-control-layers-list{color:var(--text);font-size:13px}
  .leaflet-control-layers-base label{display:flex;align-items:center;gap:6px;padding:4px;cursor:pointer;transition:background 0.2s}
  .leaflet-control-layers-base label:hover{background:rgba(96,165,250,0.1);border-radius:4px}
  .leaflet-control-layers-separator{border-top:1px solid #374151;margin:4px 0}
  .leaflet-control-layers input{cursor:pointer}
  
  .leaflet-control-zoom{border:2px solid var(--accent);border-radius:8px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,0.5)}
  .leaflet-control-zoom a{background:var(--panel);color:var(--text);border-bottom:1px solid #374151;width:36px;height:36px;line-height:36px;font-size:20px;font-weight:bold}
  .leaflet-control-zoom a:hover{background:#1f2937}
  .leaflet-control-zoom a:last-child{border-bottom:none}
  .leaflet-bar{box-shadow:none}
  
  .leaflet-control-scale{background:rgba(17,24,39,0.9);border:2px solid var(--accent);border-radius:6px;padding:2px 8px;font-size:11px;font-weight:bold;color:var(--text);box-shadow:0 2px 8px rgba(0,0,0,0.5)}
  .leaflet-control-scale-line{border:2px solid var(--accent);border-top:none;color:var(--text);background:transparent}
  
  .cone {width:0;height:0;border-left:8px solid transparent;border-right:8px solid transparent;border-bottom:20px solid #ff6a00;position:relative;transform:translate(-8px,-20px);filter:drop-shadow(0 1px 0 #7a2d00);}
  .cone:after {content:"";position:absolute;left:-10px;bottom:-5px;width:20px;height:5px;background:#7a2d00;border-radius:3px;}
  .station-label {background:#1e293b;color:white;padding:1px 4px;border-radius:3px;font-size:10px;font-weight:bold;white-space:nowrap;border:1px solid #475569}
  .sign-pill {display:inline-flex;align-items:center;gap:6px;padding:4px 6px;border-radius:8px;background:#facc15;color:#111827;border:2px solid #000;box-shadow:0 1px 0 rgba(0,0,0,.6);font-weight:700;user-select:none;cursor:grab;font-size:10px;line-height:1.1}
  .sign-palette {display:grid;grid-template-columns:1fr 1fr;gap:6px;max-height:300px;overflow-y:auto;padding:4px}
  .radio-row{display:flex;gap:8px;align-items:center;flex-wrap:wrap;font-size:12px;margin:4px 0}
  .radio-row label{display:flex;gap:4px;align-items:center;color:#e5e7eb;margin:0}
  .topline{display:flex;align-items:center;justify-content:space-between;gap:6px;margin-bottom:8px}
  .topline .inline-btns{display:flex;gap:6px}
  .chk-row{display:flex;gap:6px;align-items:center;color:#e5e7eb;font-size:12px;margin:4px 0}
  .handle{background:#111827;border:1px solid #475569;color:#e5e7eb;border-radius:6px;padding:2px 6px;font-size:10px;margin-top:4px}
  .rot-toolbar{background:#111827;border:1px solid #475569;color:#e5e7eb;border-radius:6px;padding:2px 4px;font-size:11px;display:flex;gap:6px;align-items:center}
  .rot-btn{background:#374151;color:#e5e7eb;border-radius:4px;border:1px solid #64748b;padding:1px 4px;cursor:pointer}

  @keyframes arrow-blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.3; }
  }
  .arrow-board{background:#000;border:3px solid #f59e0b;padding:4px;border-radius:4px;display:flex;gap:2px}
  .arrow-segment{width:6px;height:20px;background:#f59e0b;animation:arrow-blink 0.5s infinite}
  .arrow-segment:nth-child(2){animation-delay:0.15s}
  .arrow-segment:nth-child(3){animation-delay:0.3s}

  .taper-badge {background:var(--success);color:white;padding:2px 6px;border-radius:4px;font-size:11px;font-weight:bold;white-space:nowrap;}
  .taper-badge.short {background:var(--danger);}
  .taper-badge.warning {background:var(--warn);color:#000}
  .leaflet-popup-content-wrapper.dark-popup {background:#111827;color:#e5e7eb;border:1px solid #475569;border-radius:8px;}
  .leaflet-popup-tip.dark-popup {background:#111827;}

  .measure-line{stroke:#22c55e;stroke-width:3;stroke-dasharray:5,5}
  .measure-label{background:var(--success);color:#000;padding:2px 6px;border-radius:4px;font-size:11px;font-weight:bold}

  .mobile-toggle{display:none}
  
  .theme-toggle{position:fixed;top:10px;right:10px;z-index:2000;background:var(--panel);border:2px solid var(--accent);padding:8px 12px;border-radius:8px;cursor:pointer;font-size:20px;box-shadow:0 2px 8px rgba(0,0,0,0.3);transition:all 0.3s}
  .theme-toggle:hover{transform:scale(1.1)}
  
  .weather-widget{background:var(--panel);border:1px solid #374151;border-radius:8px;padding:8px;margin-top:8px;display:flex;align-items:center;gap:8px}
  .weather-icon{font-size:32px}
  .weather-info{flex:1}
  .weather-temp{font-size:18px;font-weight:bold;color:var(--accent)}
  .weather-desc{font-size:11px;color:var(--muted)}
  .weather-wind{font-size:10px;color:var(--muted);margin-top:2px}
  
  .material-list{margin-top:6px}
  .material-item{display:flex;justify-content:space-between;align-items:center;padding:6px 8px;background:var(--panel);border:1px solid #374151;border-radius:6px;margin-bottom:4px;font-size:12px}
  .material-item:hover{background:#1f2937}
  .material-qty{font-weight:bold;color:var(--accent);min-width:40px;text-align:right}
  .material-cost{color:var(--success);font-size:11px}
  
  .phase-list{margin-top:6px}
  .phase-item{background:var(--panel);border:1px solid #374151;border-radius:8px;padding:8px;margin-bottom:6px;cursor:pointer;transition:all 0.2s}
  .phase-item:hover{border-color:var(--accent)}
  .phase-item.active{border-color:var(--accent);background:#1e293b}
  .phase-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}
  .phase-name{font-weight:bold;font-size:13px}
  .phase-date{font-size:11px;color:var(--muted)}
  .phase-stats{font-size:11px;color:var(--muted);display:flex;gap:12px}
  .phase-controls{display:flex;gap:4px;margin-top:6px}
  .phase-controls button{flex:1;padding:4px;font-size:11px}
  
  .history-list{max-height:300px;overflow-y:auto;margin-top:6px}
  .history-item{background:var(--panel);border:1px solid #374151;border-radius:6px;padding:8px;margin-bottom:6px;cursor:pointer;transition:all 0.2s}
  .history-item:hover{border-color:var(--accent);background:#1f2937}
  .history-header{font-weight:bold;font-size:12px;margin-bottom:2px}
  .history-meta{font-size:10px;color:var(--muted);display:flex;gap:8px}
  .history-stats{font-size:11px;margin-top:4px;color:var(--text)}
  
  .ar-distance-marker{position:absolute;pointer-events:none;transition:all 0.2s ease}
  .ar-distance-ring{width:80px;height:80px;border:3px solid var(--success);border-radius:50%;position:relative;background:radial-gradient(circle at center, rgba(34,197,94,0.2) 0%, transparent 70%);animation:pulse 2s ease-in-out infinite}
  .ar-distance-label{position:absolute;bottom:-25px;left:50%;transform:translateX(-50%);background:rgba(17,24,39,0.95);color:var(--success);padding:3px 8px;border-radius:6px;font-size:12px;font-weight:bold;white-space:nowrap;border:1px solid var(--success);box-shadow:0 2px 6px rgba(0,0,0,0.8)}
  .ar-ground-grid{position:absolute;pointer-events:none}
  .ar-ground-line{stroke:rgba(34,197,94,0.3);stroke-width:1;stroke-dasharray:5,5}
  
  .progress-bar{background:#374151;border-radius:8px;height:24px;overflow:hidden;margin:6px 0;position:relative}
  .progress-fill{background:linear-gradient(90deg, var(--success) 0%, #10b981 100%);height:100%;transition:width 0.5s ease;display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:bold;color:#000}
  .progress-label{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:11px;font-weight:bold;color:var(--text);text-shadow:0 1px 2px rgba(0,0,0,0.5);z-index:1}
  
  .share-options{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:12px}
  .share-btn{padding:12px;background:var(--panel);border:2px solid var(--accent);border-radius:8px;cursor:pointer;text-align:center;font-size:12px;transition:all 0.2s}
  .share-btn:hover{background:var(--accent);color:#000}
  .share-btn-icon{font-size:24px;margin-bottom:4px}
  .share-link{background:var(--panel);border:1px solid #374151;border-radius:6px;padding:8px;margin-top:8px;font-family:monospace;font-size:11px;word-break:break-all;max-height:100px;overflow-y:auto}
  
  .offline-banner{position:fixed;top:0;left:0;right:0;background:var(--warn);color:#000;padding:8px;text-align:center;font-weight:bold;z-index:10000;display:none}
  .offline-banner.show{display:block}
  
  .traffic-calc{margin-top:8px}
  .traffic-input{display:grid;grid-template-columns:2fr 1fr;gap:6px;margin-bottom:6px}
  .traffic-result{background:#1e293b;border-radius:6px;padding:8px;margin-top:6px}
  .traffic-result-value{font-size:20px;font-weight:bold;color:var(--accent)}
  .traffic-result-label{font-size:11px;color:var(--muted)}
  
  @media (max-width: 768px) {
    #app{grid-template-columns:1fr}
    aside{max-width:100%;border-right:none;border-bottom:1px solid #1f2937}
    .theme-toggle{top:60px;right:10px}
    h1{font-size:14px}
    .btns{grid-template-columns:1fr}
    .btns3{grid-template-columns:1fr}
    .row{grid-template-columns:1fr}
    .sign-palette{grid-template-columns:1fr}
    .weather-widget{flex-direction:column;text-align:center}
    .share-options{grid-template-columns:1fr}
  }

  .print-panel{display:none}
  @media print{
    body{background:white;color:black}
    #app{grid-template-columns:1fr}
    aside,.mobile-toggle{display:none}
    #map{height:7in;page-break-after:always}
    .print-panel{display:block;padding:12px;page-break-before:always}
    .print-panel h2{margin:8px 0 6px;font-size:18px;border-bottom:2px solid #000;padding-bottom:4px}
    .print-panel h3{margin:10px 0 4px;font-size:14px}
    .print-panel .cols{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    .print-panel table{width:100%;border-collapse:collapse;margin:8px 0;font-size:12px}
    .print-panel th{background:#e5e7eb;padding:4px 8px;text-align:left;border:1px solid #000}
    .print-panel td{padding:4px 8px;border:1px solid #000}
    .qr-section{margin-top:16px;padding:12px;border:2px solid #000;text-align:center;background:white;page-break-inside:avoid}
    .qr-section h3{margin-top:0}
    .qr-section canvas{border:20px solid white !important;background:white !important;display:block !important;margin:10px auto !important;max-width:300px !important;height:auto !important}
    .qr-section #qrcode{min-height:280px;display:block !important}
    .qr-url-display{display:none !important}
    #screenshot1, #screenshot2{max-width:100% !important;height:auto !important;page-break-inside:avoid}
  }

  #fieldView{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:var(--bg);z-index:10000}
  #fieldView.active{display:flex;flex-direction:column}
  #fieldViewMap{flex:1;width:100%;position:relative}
  .field-header{background:var(--panel);padding:12px;border-bottom:2px solid var(--accent);box-shadow:0 2px 8px rgba(0,0,0,0.3)}
  .field-header h2{margin:0 0 4px;font-size:18px;color:var(--accent)}
  .field-header .info{font-size:12px;color:var(--muted)}
  
  .filter-bar{display:flex;gap:6px;padding:10px;background:var(--panel);border-bottom:1px solid #374151;overflow-x:auto;flex-wrap:wrap}
  .filter-btn{padding:6px 12px;border-radius:8px;border:2px solid #374151;background:#1f2937;color:var(--text);font-size:12px;font-weight:600;cursor:pointer;white-space:nowrap;transition:all 0.2s}
  .filter-btn:hover{background:#374151}
  .filter-btn.active{background:var(--accent);color:#000;border-color:var(--accent)}
  .filter-btn.taper{border-color:#22c55e}
  .filter-btn.taper.active{background:#22c55e}
  .filter-btn.buffer{border-color:#f59e0b}
  .filter-btn.buffer.active{background:#f59e0b}
  .filter-btn.sign{border-color:#facc15}
  .filter-btn.sign.active{background:#facc15}
  
  .nav-panel{position:absolute;top:10px;left:10px;right:10px;background:rgba(17,24,39,0.95);border-radius:8px;padding:8px 10px;z-index:1000;border:2px solid var(--accent);box-shadow:0 4px 12px rgba(0,0,0,0.5);backdrop-filter:blur(10px)}
  .nav-panel.hidden{display:none}
  .nav-distance{font-size:24px;font-weight:bold;color:var(--accent);line-height:1;margin-bottom:2px}
  .nav-direction{font-size:12px;color:var(--text);margin-bottom:4px;display:flex;align-items:center;gap:6px}
  .nav-device{font-size:11px;color:var(--muted);border-top:1px solid #374151;padding-top:4px;margin-top:4px}
  .nav-device strong{color:var(--text)}
  
  .compass-container{position:absolute;top:80px;left:50%;transform:translateX(-50%);z-index:1000;pointer-events:none}
  .compass-arrow{width:50px;height:50px;background:rgba(34,197,94,0.95);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:28px;box-shadow:0 4px 12px rgba(0,0,0,0.5);border:3px solid #fff;transition:transform 0.3s ease}
  .compass-accuracy{background:rgba(17,24,39,0.9);color:var(--muted);padding:2px 6px;border-radius:4px;font-size:9px;text-align:center;margin-top:4px}
  
  .guidance-line{stroke:#22c55e;stroke-width:3;stroke-dasharray:8,8;stroke-linecap:round;opacity:0.8;animation:dashMove 1s linear infinite}
  @keyframes dashMove{to{stroke-dashoffset:-16}}
  
  .field-controls{background:var(--panel);padding:8px;border-top:1px solid #1f2937;display:flex;gap:6px;flex-wrap:wrap}
  .field-controls button{flex:1;min-width:100px;padding:6px 8px;font-size:11px}
  .field-legend{display:flex;gap:8px;justify-content:center;padding:4px;font-size:9px;color:var(--muted);flex-basis:100%;border-top:1px solid #374151;margin-top:2px;padding-top:4px;line-height:1.2}
  .field-legend-item{display:flex;align-items:center;gap:3px}
  .field-legend-dot{width:10px;height:10px;border-radius:50%;border:2px solid #000}
  .device-popup{font-size:13px;line-height:1.5}
  .device-popup strong{color:var(--accent);display:block;margin-bottom:4px;font-size:14px}
  .device-popup .coord{color:var(--muted);font-size:11px;font-family:monospace}
  .placement-marker{background:var(--success);color:#000;padding:4px 8px;border-radius:6px;font-weight:bold;font-size:11px;border:2px solid #000;box-shadow:0 2px 4px rgba(0,0,0,0.3)}
  .placement-marker.placed{background:#6b7280;opacity:0.5}
  
  .field-cone{width:32px;height:32px;background:#ff6a00;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:bold;font-size:14px;color:#fff;border:3px solid #000;box-shadow:0 2px 6px rgba(0,0,0,0.5);position:relative}
  .field-cone.placed{background:#6b7280;opacity:0.6}
  .field-cone::after{content:attr(data-num);position:absolute;bottom:-2px;right:-2px;background:#000;color:#fff;border-radius:50%;width:16px;height:16px;font-size:10px;display:flex;align-items:center;justify-content:center;border:2px solid #fff}
  
  .field-sign{width:36px;height:36px;background:#facc15;border-radius:4px;display:flex;align-items:center;justify-content:center;font-weight:bold;font-size:18px;border:3px solid #000;box-shadow:0 2px 6px rgba(0,0,0,0.5);position:relative}
  .field-sign.placed{background:#6b7280;opacity:0.6}
  .field-sign::after{content:attr(data-num);position:absolute;bottom:-2px;right:-2px;background:#000;color:#fff;border-radius:50%;width:16px;height:16px;font-size:10px;display:flex;align-items:center;justify-content:center;border:2px solid #fff}
  
  .field-taper{background:#22c55e}
  .field-buffer{background:#f59e0b}
  
  .arrival-banner{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:var(--success);color:#000;padding:20px 30px;border-radius:12px;font-size:20px;font-weight:bold;z-index:2000;box-shadow:0 8px 24px rgba(0,0,0,0.5);animation:popIn 0.3s ease;border:4px solid #fff}
  @keyframes popIn{from{transform:translate(-50%,-50%) scale(0.5);opacity:0} to{transform:translate(-50%,-50%) scale(1);opacity:1}}

  #arView{display:none;position:absolute;top:0;left:0;right:0;bottom:0;z-index:1500;background:#000}
  #arView.active{display:flex;flex-direction:column}
  #arCamera{width:100%;height:100%;object-fit:cover}
  .ar-overlay{position:absolute;top:0;left:0;right:0;bottom:0;pointer-events:none}
  .ar-hud{position:absolute;top:10px;left:50%;transform:translateX(-50%);background:rgba(17,24,39,0.95);padding:8px 12px;border-radius:8px;border:2px solid var(--accent);color:var(--text);text-align:center;font-weight:bold;backdrop-filter:blur(10px);max-width:90%;z-index:1001}
  .ar-distance{font-size:24px;color:var(--accent);line-height:1}
  .ar-direction{font-size:11px;margin-top:3px;color:var(--muted);line-height:1.3}
  .ar-tip{font-size:9px;margin-top:4px;color:#60a5fa;opacity:0.8}
  .ar-arrow{position:absolute;top:50%;left:50%;width:80px;height:80px;margin-left:-40px;margin-top:-40px;transition:transform 0.3s ease}
  .ar-arrow svg{width:100%;height:100%;filter:drop-shadow(0 4px 8px rgba(0,0,0,0.5))}
  .ar-reticle{position:absolute;top:50%;left:50%;width:60px;height:60px;margin-left:-30px;margin-top:-30px;border:3px solid var(--accent);border-radius:50%;animation:pulse 1.5s ease-in-out infinite}
  @keyframes pulse{0%,100%{transform:scale(1);opacity:0.6} 50%{transform:scale(1.2);opacity:1}}
  
  .ar-device{position:absolute;transition:all 0.2s ease;pointer-events:none;z-index:10;transform-style:preserve-3d}
  .ar-device.current{animation:highlight 1s ease-in-out infinite}
  @keyframes highlight{0%,100%{filter:drop-shadow(0 4px 12px rgba(96,165,250,1)) drop-shadow(0 0 20px rgba(96,165,250,0.8))} 50%{filter:drop-shadow(0 4px 20px rgba(96,165,250,0.5))}}
  
  .ar-cone-3d{width:60px;height:80px;position:relative;transform-style:preserve-3d}
  .cone-body{position:absolute;bottom:10px;left:50%;transform:translateX(-50%);width:0;height:0;border-left:30px solid transparent;border-right:30px solid transparent;border-bottom:60px solid #ff6a00;filter:drop-shadow(2px 4px 6px rgba(0,0,0,0.5))}
  .cone-body::before{content:'';position:absolute;bottom:0;left:-30px;width:0;height:0;border-left:30px solid transparent;border-right:30px solid transparent;border-bottom:60px solid #d85500;opacity:0.6;transform:rotateY(45deg)}
  .cone-base-3d{position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:50px;height:12px;background:radial-gradient(ellipse at center, #8b3500 0%, #6b2700 100%);border-radius:50%;box-shadow:0 2px 8px rgba(0,0,0,0.6)}
  .cone-shadow{position:absolute;bottom:-5px;left:50%;transform:translateX(-50%);width:55px;height:8px;background:radial-gradient(ellipse at center, rgba(0,0,0,0.4) 0%, transparent 70%);border-radius:50%}
  .cone-stripe{position:absolute;bottom:30px;left:50%;transform:translateX(-50%);width:40px;height:8px;background:#fff;clip-path:polygon(0 0, 100% 0, 90% 100%, 10% 100%);opacity:0.9}
  
  .ar-device.taper .cone-body{border-bottom-color:#22c55e}
  .ar-device.taper .cone-body::before{border-bottom-color:#16a34a}
  
  .ar-device.buffer .cone-body{border-bottom-color:#f59e0b}
  .ar-device.buffer .cone-body::before{border-bottom-color:#d97706}
  
  .ar-sign-3d{width:70px;height:90px;position:relative;transform-style:preserve-3d}
  .sign-post{position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:8px;height:50px;background:linear-gradient(to right, #666 0%, #888 50%, #666 100%);border-radius:4px;box-shadow:2px 2px 4px rgba(0,0,0,0.5)}
  .sign-post::before{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(to bottom, rgba(255,255,255,0.2) 0%, transparent 50%);border-radius:4px}
  .sign-panel{position:absolute;bottom:30px;left:50%;transform:translateX(-50%);width:50px;height:50px;background:linear-gradient(135deg, #facc15 0%, #fde047 50%, #facc15 100%);border:4px solid #000;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:28px;box-shadow:0 4px 8px rgba(0,0,0,0.5), inset -2px -2px 4px rgba(0,0,0,0.2), inset 2px 2px 4px rgba(255,255,255,0.3);transform-style:preserve-3d}
  .sign-panel::before{content:'';position:absolute;top:-4px;left:-4px;right:-4px;bottom:-4px;border:2px solid rgba(255,255,255,0.3);border-radius:8px;pointer-events:none}
  .sign-shadow{position:absolute;bottom:-5px;left:50%;transform:translateX(-50%);width:60px;height:10px;background:radial-gradient(ellipse at center, rgba(0,0,0,0.4) 0%, transparent 70%);border-radius:50%}
  
  .ar-device-label{position:absolute;bottom:-25px;left:50%;transform:translateX(-50%);background:rgba(17,24,39,0.95);color:#fff;padding:3px 8px;border-radius:6px;font-size:11px;white-space:nowrap;font-weight:bold;border:1px solid rgba(96,165,250,0.5);box-shadow:0 2px 6px rgba(0,0,0,0.8)}
  .ar-device.placed{opacity:0.4;filter:grayscale(0.5)}
  
  .ar-ground-line{position:absolute;left:0;right:0;height:2px;background:rgba(34,197,94,0.5);box-shadow:0 0 10px rgba(34,197,94,0.5);pointer-events:none}
  
  .ar-snap{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:var(--success);color:#000;padding:24px 40px;border-radius:16px;font-size:24px;font-weight:bold;border:4px solid #fff;box-shadow:0 8px 24px rgba(0,0,0,0.8);animation:snapPulse 0.5s ease;z-index:100}
  @keyframes snapPulse{0%,100%{transform:translate(-50%,-50%) scale(1)} 50%{transform:translate(-50%,-50%) scale(1.1)}}
  .ar-controls{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);display:flex;gap:12px}
  .ar-controls button{padding:12px 24px;border-radius:12px;border:2px solid var(--accent);background:rgba(17,24,39,0.9);color:var(--text);font-weight:bold;font-size:14px;cursor:pointer;backdrop-filter:blur(10px)}
  .ar-controls button:active{background:var(--accent);color:#000}

  .modal{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.8);z-index:9999;align-items:center;justify-content:center}
  .modal.active{display:flex}
  .modal-content{background:var(--panel);border-radius:12px;padding:20px;max-width:400px;width:90%;border:2px solid var(--accent)}
  .modal-header{font-size:18px;font-weight:bold;margin-bottom:12px;color:var(--accent)}
  .modal-body{text-align:center}
  .modal-footer{margin-top:16px;display:flex;gap:8px}
  .modal-footer button{flex:1}
  
  @keyframes confettiFall {
    0% { transform: translateY(0) rotate(0deg); opacity: 1; }
    100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
  }
  @keyframes slideDown {
    from { transform: translate(-50%, -100%); opacity: 0; }
    to { transform: translate(-50%, 0); opacity: 1; }
  }
  @keyframes slideUp {
    from { transform: translate(-50%, 0); opacity: 1; }
    to { transform: translate(-50%, -100%); opacity: 0; }
  }


/****************************************
 * PART 0 - CSS STYLES
 * END
 ****************************************/
